source 'https://rubygems.org'

# Path resolution for sibling oc-chef-pedant:
# We support multiple checkout layouts (repo at /workdir/chef-server or flattened at /).
# Try candidates and pick the first that actually contains the gemspec.
_oc_pedant_candidates = [
  File.expand_path('../../oc-chef-pedant', __dir__), # typical Windows/local: /workdir/chef-server/scripts/bk_tests -> /workdir/chef-server/oc-chef-pedant
  File.expand_path('../oc-chef-pedant', __dir__),    # flattened CI: /scripts/bk_tests -> /oc-chef-pedant
  File.expand_path('../../../oc-chef-pedant', __dir__) # nested scenarios
].uniq
_oc_pedant_path = _oc_pedant_candidates.find { |p| File.exist?(File.join(p, 'oc-chef-pedant.gemspec')) }
raise "Cannot locate oc-chef-pedant gemspec. Tried: #{_oc_pedant_candidates.join(', ')}" unless _oc_pedant_path

gem 'oc-chef-pedant', path: _oc_pedant_path
# For debugging in dvm
gem 'pry'
gem 'pry-byebug'
gem 'pry-stack_explorer'
gem 'rake'
# rest-client fork with UCRT Windows support
gem 'rest-client', git: 'https://github.com/chef/rest-client', branch: 'jfm/ucrt_update1'

# Chef gem not needed - chef-zero now uses ENV['CHEF_VERSION'] instead of Chef::VERSION
# gem 'chef',  "~> 18.8.46"
# For "rake chef_zero_spec"
# PR #352 merged to main but not released yet - use main branch
gem 'chef-zero', github: 'chef/chef-zero', branch: 'main'

# If you want to load debugging tools into the bundle exec sandbox,
# # add these additional dependencies into Gemfile.local
eval(IO.read(__FILE__ + '.local'), binding) if File.exist?(__FILE__ + '.local')

instance_eval(ENV['GEMFILE_MOD']) if ENV['GEMFILE_MOD']
